---
title: "doomsayer_diagnostics"
output:
  html_document:
      toc: true
      toc_float: true
      keep_md: yes
      theme: united
  pdf_document:
date: '`r format(Sys.Date())`'
params:
  dev: no
  yaml_cfg: x
---

<style>
body {
    position: absolute;
    left: 0px;}
</style>

```{r child="R/setup.Rmd"}
```

```{r child="R/sigloads.Rmd"}
```

### Component value distributions

This plot shows the distribution of scores for each principal component (if using PCA) or NMF component (if using NMF) across the N individuals in your sample.

If any component shows clear evidence of multimodality, consider changing the default outlier detection from `--filtermode ee` (elliptic envelope) to either `--filtermode lof` (local outlier factor) or `--filtermode if` (isolation forest)

```{r child="R/contribs_hist.Rmd"}
```

### Error profile heatmap

Fold-difference in contribution per subtype for each outlier. Fold-differences are calculated relative to the mean contribution of that subtype across all samples. Scale is truncated to +/-5-fold difference

```{r child="R/heatmap.Rmd"}
```

### Compare mutation spectra of retained samples and outliers

Each bar represents the fraction of observations contained within each K-mer subtype among the kept samples (blue) versus the flagged outliers (red)

```{r child="R/spectra.Rmd"}
```

### Signature loadings (H matrix)

Describes how each mutation subtype is loaded into the r signatures

```{r child="R/sigloads_bar.Rmd"}
```
