## Diagnostic plots for Doomsayer

This directory contains R scripts for evaluating the results of a Doomsayer run where the `--diagnostics` option has been enabled.

From the command line, you can run:

```{sh id:"chj4m1wcp3"}
Rscript diagnostics/doomsayer_diagnostics.r /path/to/doomsayer_output/diagnostics.yaml
```

This will copy the `diagnostics.Rmd` RMarkdown template into `/path/to/doomsayer_output` and render customized HTML and PDF reports in the output directory with useful diagnostic information. Doing so requires the `rmarkdown` package be installed.

`diagnostics.Rmd` requires the following R packages:
- [yaml]
- [dplyr]
- [tidyr]
- [ggplot2]
- [devtools]

The script will check if they are installed, and attempt to download any that are not found. Packages will be installed to your default library location.

All diagnostic plots will be created in `doomsayer_output/figures/`

Below is a description of the various plots that are generated by default. This script is designed to be a starting point for more detailed diagnostics custom to your analysis.

### Total singleton counts per sample

This provides a quick visual diagnostic to identify any samples with an exceptionally high number of variants, which may be an indicator of widespread sequencing error.

### Mutation spectra observed across all samples

This plot provides a breakdown of the variant frequencies in each mutation subtype.

### Signature loadings (H Matrix)

This plot shows how each mutation subtype is loaded within each signature.

### Signature contributions per sample (W matrix)

This plot displays how much each signature contributes to the singleton distribution of each sample. This is particularly useful if sample IDs are roughly organized by the batch in which they were sequenced--a common pattern is that

### Dominant signature frequency table

Here, we tabulate the number of samples for which each signature is the dominant signature.
